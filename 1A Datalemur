-- Datalemur SQL Learning

-- Histogram of Tweets
  WITH twt_cnt AS (
  SELECT COUNT(tweet_id) AS tweet_bucket, user_id FROM tweets
  WHERE EXTRACT(YEAR FROM tweet_date) = 2022
  GROUP BY user_id
  )
  SELECT tweet_bucket, COUNT(DISTINCT user_id) AS user_id
  FROM twt_cnt
  GROUP BY tweet_bucket
  ORDER BY tweet_bucket;

-- LinkedIn SQL Interview Questions
  WITH Grades AS 
  (
  SELECT candidate_id
    , skill
    , CASE WHEN skill in ('Python', 'Tableau', 'PostgreSQL')
      THEN 1
      ELSE 0
      END AS valuable
    FROM candidates
  )
  SELECT candidate_id
    FROM Grades
    GROUP BY candidate_id
    HAVING SUM(valuable) >= 3;


-- Tesla SQL Interview Question
  SELECT part, assembly_step
  FROM parts_assembly
  WHERE finish_date IS NULL;

-- Facebook SQL Interview Questions
  SELECT DISTINCT p.page_id
  FROM pages AS p 
  LEFT JOIN page_likes AS l 
    ON p.page_id = l.page_id
    WHERE l.user_id IS NULL;


-- Laptop vs. Mobile Viewership 
SELECT COUNT(DISTINCT user_id) AS laptop_views
FROM viewership
WHERE device_type = 'laptop';





